<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Koen Hufkens" />

<meta name="date" content="2019-03-01" />

<title>MODISTools</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">MODISTools</h1>
<h4 class="author"><em>Koen Hufkens</em></h4>
<h4 class="date"><em>2019-03-01</em></h4>



<p>The MODISTools package has as goal to facilitate the interface between R and the MODIS Land Product Subset API at the Oak Ridge National Laboratory DAAC. This programmatic interface to the <a href="https://modis.ornl.gov/data/modis_webservice.html">‘MODIS Land Products Subsets’ web services</a> allows for easy downloads of ‘MODIS’ time series directly to your R workspace or your computer. Below an example is provided on how to download a MODIS time series as well as list ancillary data.</p>
<div id="listing-products-bands-dates" class="section level3">
<h3>Listing products / bands / dates</h3>
<p>In order to assess which products are available, which product bands are provided and which temporal range is covered one has to list these ancillary data. All these options can be queried using the <code>mt_*()</code> functions.</p>
<p>To list all available products use the mt_products() function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">products &lt;-<span class="st"> </span><span class="kw">mt_products</span>()
<span class="kw">head</span>(products)
<span class="co">#&gt;    product</span>
<span class="co">#&gt; 1   Daymet</span>
<span class="co">#&gt; 2  MCD12Q1</span>
<span class="co">#&gt; 3  MCD12Q2</span>
<span class="co">#&gt; 4 MCD15A2H</span>
<span class="co">#&gt; 5 MCD15A3H</span>
<span class="co">#&gt; 6  MCD19A3</span>
<span class="co">#&gt;                                                                        description</span>
<span class="co">#&gt; 1  Daily Surface Weather Data (Daymet) on a 1-km Grid for North America, Version 3</span>
<span class="co">#&gt; 2            MODIS/Terra+Aqua Land Cover Type (LC) Yearly L3 Global 500 m SIN Grid</span>
<span class="co">#&gt; 3       MODIS/Terra+Aqua Land Cover Dynamics (LCD) Yearly L3 Global 500 m SIN Grid</span>
<span class="co">#&gt; 4 MODIS/Terra+Aqua Leaf Area Index/FPAR (LAI/FPAR)  8-Day L4 Global 500 m SIN Grid</span>
<span class="co">#&gt; 5  MODIS/Terra+Aqua Leaf Area Index/FPAR (LAI/FPAR) 4-Day L4 Global 500 m SIN Grid</span>
<span class="co">#&gt; 6     MODIS/Terra+Aqua BRDF Model Parameters (MAIAC) 8-Day L3 Global 1 km SIN Grid</span>
<span class="co">#&gt;   frequency resolution_meters</span>
<span class="co">#&gt; 1     1 day              1000</span>
<span class="co">#&gt; 2    1 year               500</span>
<span class="co">#&gt; 3    1 year               500</span>
<span class="co">#&gt; 4     8 day               500</span>
<span class="co">#&gt; 5     4 day               500</span>
<span class="co">#&gt; 6     8 day              1000</span></code></pre></div>
<p>To list all available bands for a given product use the mt_bands() function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bands &lt;-<span class="st"> </span><span class="kw">mt_bands</span>(<span class="dt">product =</span> <span class="st">&quot;MOD13Q1&quot;</span>)
<span class="kw">head</span>(bands)
<span class="co">#&gt;                             band                     description</span>
<span class="co">#&gt; 1        250m_16_days_VI_Quality           VI quality indicators</span>
<span class="co">#&gt; 2  250m_16_days_blue_reflectance      Surface Reflectance Band 3</span>
<span class="co">#&gt; 3 250m_16_days_pixel_reliability Quality reliability of VI pixel</span>
<span class="co">#&gt; 4   250m_16_days_NIR_reflectance      Surface Reflectance Band 2</span>
<span class="co">#&gt; 5   250m_16_days_MIR_reflectance      Surface Reflectance Band 7</span>
<span class="co">#&gt; 6              250m_16_days_NDVI             16 day NDVI average</span>
<span class="co">#&gt;                   units    valid_range fill_value</span>
<span class="co">#&gt; 1             bit field     0 to 65534         -1</span>
<span class="co">#&gt; 2           reflectance     0 to 10000      -1000</span>
<span class="co">#&gt; 3                  rank         0 to 3         -1</span>
<span class="co">#&gt; 4           reflectance     0 to 10000      -1000</span>
<span class="co">#&gt; 5           reflectance     0 to 10000      -1000</span>
<span class="co">#&gt; 6 NDVI ratio - No units -2000 to 10000      -3000</span></code></pre></div>
<p>To list all available dates (temporal coverage) for a given product and location use the mt_dates() function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dates &lt;-<span class="st"> </span><span class="kw">mt_dates</span>(<span class="dt">product =</span> <span class="st">&quot;MOD13Q1&quot;</span>, <span class="dt">lat =</span> <span class="dv">42</span>, <span class="dt">lon =</span> <span class="op">-</span><span class="dv">110</span>)
<span class="kw">head</span>(dates)
<span class="co">#&gt;   modis_date calendar_date</span>
<span class="co">#&gt; 1   A2000049    2000-02-18</span>
<span class="co">#&gt; 2   A2000065    2000-03-05</span>
<span class="co">#&gt; 3   A2000081    2000-03-21</span>
<span class="co">#&gt; 4   A2000097    2000-04-06</span>
<span class="co">#&gt; 5   A2000113    2000-04-22</span>
<span class="co">#&gt; 6   A2000129    2000-05-08</span></code></pre></div>
</div>
<div id="downloading-modis-time-series" class="section level3">
<h3>Downloading MODIS time series</h3>
<p>Once you decide on which data to download using the above functions you can use these parameters to download a time series using the <code>mt_subset()</code> function. The below query downloads MOD11A2 based daytime lands surface temperatures. The location is named ‘testsite’ and only covers the first six months of 2004. The output is saved to a variable called subset in the R workspace (as defined by the parameter internal = TRUE, when set to FALSE the data is written to file).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># download data</span>
subset &lt;-<span class="st"> </span><span class="kw">mt_subset</span>(<span class="dt">product =</span> <span class="st">&quot;MOD13Q1&quot;</span>,
                    <span class="dt">lat =</span> <span class="fl">42.534171</span>,
                    <span class="dt">lon =</span> <span class="op">-</span><span class="fl">72.179003</span>,
                    <span class="dt">band =</span> <span class="st">&quot;250m_16_days_NDVI&quot;</span>,
                    <span class="dt">start =</span> <span class="st">&quot;2004-01-01&quot;</span>,
                    <span class="dt">end =</span> <span class="st">&quot;2005-12-30&quot;</span>,
                    <span class="dt">km_lr =</span> <span class="dv">0</span>,
                    <span class="dt">km_ab =</span> <span class="dv">0</span>,
                    <span class="dt">site_name =</span> <span class="st">&quot;testsite&quot;</span>,
                    <span class="dt">internal =</span> <span class="ot">TRUE</span>,
                    <span class="dt">progress =</span> <span class="ot">FALSE</span>)
<span class="kw">head</span>(subset)
<span class="co">#&gt;       xllcorner  yllcorner      cellsize nrows ncols              band</span>
<span class="co">#&gt; 1.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt; 2.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt; 3.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt; 4.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt; 5.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt; 6.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt;                     units  scale latitude longitude     site product</span>
<span class="co">#&gt; 1.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt; 2.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt; 3.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt; 4.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt; 5.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt; 6.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt;          start        end complete modis_date calendar_date   tile</span>
<span class="co">#&gt; 1.1 2004-01-01 2005-12-30     TRUE   A2004001    2004-01-01 h12v04</span>
<span class="co">#&gt; 2.1 2004-01-01 2005-12-30     TRUE   A2004017    2004-01-17 h12v04</span>
<span class="co">#&gt; 3.1 2004-01-01 2005-12-30     TRUE   A2004033    2004-02-02 h12v04</span>
<span class="co">#&gt; 4.1 2004-01-01 2005-12-30     TRUE   A2004049    2004-02-18 h12v04</span>
<span class="co">#&gt; 5.1 2004-01-01 2005-12-30     TRUE   A2004065    2004-03-05 h12v04</span>
<span class="co">#&gt; 6.1 2004-01-01 2005-12-30     TRUE   A2004081    2004-03-21 h12v04</span>
<span class="co">#&gt;         proc_date pixel value</span>
<span class="co">#&gt; 1.1 2015154120947     1 -3000</span>
<span class="co">#&gt; 2.1 2015154121734     1  5108</span>
<span class="co">#&gt; 3.1 2015154122102     1  3286</span>
<span class="co">#&gt; 4.1 2015154125157     1  2115</span>
<span class="co">#&gt; 5.1 2015154125222     1  4775</span>
<span class="co">#&gt; 6.1 2015154125302     1  5687</span></code></pre></div>
<p>The output format is a <em>tidy</em> data frame, as shown above. When witten to a csv with the parameter <code>internal = FALSE</code> this will result in a flat file on disk.</p>
<p>Note that when a a region is defined using km_lr and km_ab multiple pixels might be returned. These are indexed using the <code>pixel</code> column in the data frame containing the time series data. The remote sensing values are listed in the <code>value</code> column. When no band is specified all bands of a given product are returned, be mindful of the fact that different bands might require different multipliers to represent their true values.</p>
<p>When a large selection of locations is needed you might benefit from using the batch download function <code>mt_batch_subset()</code>, which provides a wrapper around the <code>mt_subset()</code> function in order to speed up large download batches. This function has a similar syntax to <code>mt_subset()</code> but requires a data frame defining site names (site_name) and locations (lat / lon) (or a comma delimited file with the same structure) to specify a list of download locations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create data frame with a site_name, lat and lon column</span>
<span class="co"># holding the respective names of sites and their location</span>
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;site_name&quot;</span> =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;test&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
df<span class="op">$</span>lat &lt;-<span class="st"> </span><span class="dv">40</span>
df<span class="op">$</span>lon &lt;-<span class="st"> </span><span class="op">-</span><span class="dv">110</span>

<span class="co"># an example batch download data frame</span>
<span class="kw">print</span>(df)
<span class="co">#&gt;   site_name lat  lon</span>
<span class="co">#&gt; 1    test 1  40 -110</span>
<span class="co">#&gt; 2    test 2  40 -110</span>

<span class="co"># test batch download</span>
subsets &lt;-<span class="st"> </span><span class="kw">mt_batch_subset</span>(<span class="dt">df =</span> df,
                     <span class="dt">product =</span> <span class="st">&quot;MOD11A2&quot;</span>,
                     <span class="dt">band =</span> <span class="st">&quot;LST_Day_1km&quot;</span>,
                     <span class="dt">internal =</span> <span class="ot">TRUE</span>,
                     <span class="dt">start =</span> <span class="st">&quot;2004-01-01&quot;</span>,
                     <span class="dt">end =</span> <span class="st">&quot;2004-02-28&quot;</span>,
                     <span class="dt">out_dir =</span> <span class="st">&quot;~&quot;</span>)

<span class="kw">head</span>(subsets)
<span class="co">#&gt;         xllcorner  yllcorner         cellsize nrows ncols        band</span>
<span class="co">#&gt; 1.1.1 -9370036.39 4447802.08 926.625433055834     1     1 LST_Day_1km</span>
<span class="co">#&gt; 1.2.1 -9370036.39 4447802.08 926.625433055834     1     1 LST_Day_1km</span>
<span class="co">#&gt; 1.3.1 -9370036.39 4447802.08 926.625433055834     1     1 LST_Day_1km</span>
<span class="co">#&gt; 1.4.1 -9370036.39 4447802.08 926.625433055834     1     1 LST_Day_1km</span>
<span class="co">#&gt; 1.5.1 -9370036.39 4447802.08 926.625433055834     1     1 LST_Day_1km</span>
<span class="co">#&gt; 1.6.1 -9370036.39 4447802.08 926.625433055834     1     1 LST_Day_1km</span>
<span class="co">#&gt;        units scale latitude longitude   site product      start        end</span>
<span class="co">#&gt; 1.1.1 Kelvin  0.02       40      -110 test 1 MOD11A2 2004-01-01 2004-02-28</span>
<span class="co">#&gt; 1.2.1 Kelvin  0.02       40      -110 test 1 MOD11A2 2004-01-01 2004-02-28</span>
<span class="co">#&gt; 1.3.1 Kelvin  0.02       40      -110 test 1 MOD11A2 2004-01-01 2004-02-28</span>
<span class="co">#&gt; 1.4.1 Kelvin  0.02       40      -110 test 1 MOD11A2 2004-01-01 2004-02-28</span>
<span class="co">#&gt; 1.5.1 Kelvin  0.02       40      -110 test 1 MOD11A2 2004-01-01 2004-02-28</span>
<span class="co">#&gt; 1.6.1 Kelvin  0.02       40      -110 test 1 MOD11A2 2004-01-01 2004-02-28</span>
<span class="co">#&gt;       complete modis_date calendar_date   tile     proc_date pixel value</span>
<span class="co">#&gt; 1.1.1     TRUE   A2004001    2004-01-01 h09v05 2015212185706     1 13098</span>
<span class="co">#&gt; 1.2.1     TRUE   A2004009    2004-01-09 h09v05 2015212201022     1 13062</span>
<span class="co">#&gt; 1.3.1     TRUE   A2004017    2004-01-17 h09v05 2015212213103     1 13297</span>
<span class="co">#&gt; 1.4.1     TRUE   A2004025    2004-01-25 h09v05 2015213005429     1 13323</span>
<span class="co">#&gt; 1.5.1     TRUE   A2004033    2004-02-02 h09v05 2015213090158     1 13315</span>
<span class="co">#&gt; 1.6.1     TRUE   A2004041    2004-02-10 h09v05 2015213165253     1 13227</span></code></pre></div>
</div>
<div id="worked-example-using-ndvi-values" class="section level3">
<h3>Worked example using NDVI values</h3>
<p>The above downloaded subset shows normalized difference vegetation index (NDVI), and <a href="https://earthobservatory.nasa.gov/Features/MeasuringVegetation/measuring_vegetation_2.php">an indicator of plant health, density and or complexity</a> for the experimental <a href="https://harvardforest.fas.harvard.edu/">Harvard Forest</a> site. When plotted the yearly pattern of rising and falling NDVI values shows vegetation growth in spring, and senescence or leaf drop in fall. Values lower than ~0.4 are contaminated by snow or clouds.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create a plot of the data - accounting for the multiplier (scale) component</span>
date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(subset<span class="op">$</span>calendar_date)
temperature &lt;-<span class="st"> </span>subset<span class="op">$</span>value <span class="op">*</span><span class="st"> </span><span class="kw">as.double</span>(subset<span class="op">$</span>scale)
temperature[temperature <span class="op">==</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>

<span class="kw">plot</span>(date,
     temperature,
     <span class="dt">xlab =</span> <span class="st">&quot;Date&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;NDVI&quot;</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),
     <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAEgCAMAAABcujGyAAADAFBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7////isF19AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAWkUlEQVR4nO3dd2AUxR4H8KW3FBJCmoRASGJQqlRBXhJqMAioRFCaBgiGSEBQmgqCNEF4NBEeTZTQpBNAmvAUeXRBEVCqhCISEikRQnK3b4+0u9xe2bud3d/dfT9/HHt7c7vj5uttm5nleADCOLUrAGAOAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQJrMAR3WCMAKL/ypTkCbLzsGYFnYKZUC+j95lwdOqh4CCpQpG9BTcQXcUuRYHjg9ZQN6Z22B8l/IsTxwemrt4t0Wybs8cFIIKJCGgAJpCCiQhoACaQgokIaAQqHco7NSzmnUroUhFw/oA5F52uMT4or0HL3g23MPFa+Y8s5+/or3s4O61fSIHGY5pZqMGxdPHvnfffbVYhrQzDPZpj4iENCcvYOrl6+bvD5df2bWloSnwoatLryhsPbrif3bhZULeL7HqAU7zj1Sq66MXVve56ng+BU3ddN3dk3pVtM9ctiKI8eOXbh48XpGRgavSf/90I6UueOH9unUskFIoFepkl7+IfUbN6kUFjd5+3WmVWMU0M1dYlbwC8pyZcflihdQO6BZ6/tUaTr5TO6RabGe9ZI35IU0bUGse/RnvxmX1l4/sGLSgPah5apHxU9ceegvhSvLVNaWpAifuAXnDWbe2TU1rlGjRiEhIQFeXl4c5x3atMPrSR/O/HLzDyeEzObkF8s5nfJ+Wx/f9iNWnnnMqHpsArqaa9KpzHD3idtHllogXkLVgN5e2tmz3fxr+e9yDk970bPekNUfNqzSc3Wm2S/mXt67aPRrjb3dG3QR9v5vJiQkJI0cOea82e+QdmFOB/fW00/Yd9x5LXVit9DyoTHvzNl+PsdycWnYBLR+Ly2/ipsiTL1TT7yEegG9NDOyclxKsSDmHP60y4jvTfzaG8s8vlHY+y9buHDhvKlTR1RdLXcdFZG9Z9jTAfHr7sq0tHOpMwe1r1k+rGPybnmWmIdNQCusEP6I3H5halVF8RIqBfT42Pp+A7bJfM5zPPRthzuLurPoZc/mnxzXyr3c7LNbZgSsl3GBbAIaNpLn/8vpMjghXLyECgHN2TO4eviIHxlcRrn7WgORA1fS2nT++jarZf/kt1W+hbEJ6KelBn7k+0LArtvrPEaLl1A6oP9sSfB9ZtwxVotf7utY7VvPBLA6qdE54bdNtmWxCWjO2ECfd7UJHMfFil1p5BUPaJpPhy+YXg75KXzAPyyXL7N3xjJd/I++++RaFLProMLRjXb/8mOmDnIUDujAUazXcO+N2r+wXods7ntfs1zIHgd8/yvTkljfSbpv4rqNsgG9XDXdciF7La+i/s0HK83vxnoNu/0Oy7Mg1gFtY/i9vzPyKRvQvuOUWMuvdXqbOKChpu53zFfxrZ88B/ysA/pZP/1333kVKPGpbcuzyVnfvxVZz/3ez1q7OVX1fW3ZLy8Z2xAgyyGPSzQW6T5FqTV97TvTpr99etHN/5/lrpOxHnPZr4PnVwWek2Ep7AKqvXvHzN9KyYCeDFBuz3u5ZTsbrhbsC4otaD3VOYz5r9tNb5nuHlmwPOiC/QthFNDzI0PLcVzZkBGmqqhkQDvPUm5dfO7UqqskfiVnnL/edcNnmQ9pMT6R9RryLa1+ye5lsAnoEY/AhFlfLZ89KNjzuHgJBQN6OEjZG5GHQgdI+sW+/HzMLb23k1nHJ6eaAkcReeaGbLd3EWwCGhWZ35T1UZfW4iUUDGh7Ew2qmLkfH37E5IdGO/A1vjMM5v3hw7jV6fpWbJevb/OzLe28YMAmoB6LC6a2eoqXUC6g34ewvKsnbp3fJPGWUWfiysWu0G+H/qBfePF9TGs521qIaCP1EMQempTw6AP2LIBNQJv0LPhReLepeAnlAhr1pVJr0vNnx+YiR99XEnzH3doS59FpeVb+nNN1eht1m1jalWnVzgaY7ObAhGZtaFvTOxSL2AR0bYk2i348c/bg0k4lvxEvoVhAd0ZY3cpTTprpPm+mGu6r0wb6fPzk9Dl9YVSVfnuEamlnibUxuVfZptteub9Zd/qf/KEtS7fH4wVBXU7a+mVGZ/Gp0dwT0akmCigVUG1TtVoTp81q5dV7U+H52a2hVUYWBe/ajMYBQ/bGNrso9s2e82xZ35ryPl1nHrX4f+ODKmm2LN0+D2cHxJ2x7avMroOmn9q166TpnwKlArq5vordaG/Mi67cY51ud54xukryTcMPfx/fYJT40fG3zWxZWb85N1Yn1fWMmfSD2ZOshS/bsnC7ZU3zixq18Yb0Lzr5nSRN/c2KrMekWwvaeXRbPcFnwFXrv5Nr0y2Y4LO61zubhzd1+9dY078M9ffYsGw5PPh2fKxPULfPfsiyXFaPxIDe1COxgoYUCuiapgrcdbYgfUlsH2n96t77QPpafgsqnLy/a2DwjyaKHYhQdYOcT0luVqlh4kbrvyExoJwe6dXTo0xAcyN2KrEauZ0Kln5cMu8t/Xdb/KaJB/H12bZVSUbZh2bXWmy5WD6JAf1Cjw11K6JMQL9sqcRa5Fd/v+SvdDa8unm1ZVux57f85ZVhY5VkdSHwW2uLOvUx6ONa+xRYCwOGjRStkVP5VrEZ46r/YFzsk4E21khmh/1+srKkxIDK1nlRkYAuaK/ASlj401vamYRwbNnQaNbuwHHFjxRyg0/YXCd5ra1m5Vmj1GPQhlNEL91Jxiqgmo0rN+4+/PPFdOEv/DBIpm4Hyuu4UuIXxo0wnne1ZUyxQXo20jnkmVb/nlXlJAZ0TlRJrvG0y7bVSR+jgG6v16JHl7ZN6oR4V+Aqe3dhsg4lrOwo8QstxIbzyBlVzbDvWjtCnaMTO1g1TI7kY9DbS2LLcc1mSLisJ4pJQI+2fkbvsmfGdUfqCGzoH28zV/HuGM/62128SeEO/4l6u/nf/JW9DW9Wbmx/a4rZcpJ0b3V3N66FLa2Aby4sUG6+DV8372KPaotUue/OQvwMkx+tr2TcIH6TqaPta5F+TTsPmrB0+8/C3n7oGJlqJ4v7z02yopSNZ/H3B5ew5bT+TEKBMnK3cr89xGei1DMLwvbVN/VJml/DJUYzk6abKq65dmjTvI/ejKnjU66G+x8y1U4eN4KtOOKwJaA5u/t7c6H2jU0h8y4+a1LVZKcatVMTbOIPo4mesinSaG64Fa2FHl2SoxObnE77Wr7eKzmguXsH+nCBw47aecdM1oBqFlfrLkP/LFI+eE98/pQoTXbVK8VmXvFT/46uLfb6nbVURGJA9w/y5bwT9tnfQkjOgN6NbWlHi1iizgWKHk8f8UsTdugTi81d9IYCNWJheYjY/S59Uq+DVnpjqyxngjIG9PwzSbKP60tAM7G7gffD1gmvh54uNvu1Zezrw8bHTQ6cE7kqUURiQFfJ1cNcvoDu8Ve6U5wy5vUUmRmfd2nm6UMGczU+jMcCY0c7qkW4Z2n/OlHdk8bNFbvNJf0YdMuk/v0nb7X3eo5sAZ3nL71hhUNIr2x8q2VteN4PxMQkg9lHn1GkRsxkXz+1d+WcsYPEeo9JDejuCK50jRqludp2tnuVKaA5g+vYPzYAUV2XFZ+T5pf/y3nFx+A4a/IQRSqkCokBPV2pyS7hDCl3Z2M3G/uY5LMUUOs6ztyO7GLdHV1HtL74kAK5kYUjrkVu0v/AZM8vJyAxoK/WzB/v805wnF3rtRTQqtZ0Dv8lZAyxB/fJ6ZFPsevqk9oU/tcufkVvfpa7Ak98U4vEgAYVNpp5L9jydx5vNDlQv4WAZpapbvl0bLOv1DY/jiVxssHbQ/5Fp0J3K+ud+u74l1I1UoHUy0yFbfUXWXGrM5PbZ+ojCwE93qCvSPsxA9rJQc539dPAwQj9/pn3Qjfoveuh16Fh2CdK1UgFUgO6rOD9MnMB7ZknjmvbU+xiCW8xoGtfveX7q/kKvd+U7UMi1ad90b391CMF10v6Juh/tq1F0XRdw4tOzoVNQFtzbi0Fzbg6LU00kbUQ0Ckj+PlRZm/fZXg51b13cX9vHlLHq8vs08LkqgiDpjA5/oUdRW94O00bLhFSA+rhl8/DXEA189363LFnF99/AZ/beIW5EjN6m12A8/hz1YBafq/P9S12FXtoYWOdr15VukpKkhjQJD1mi1+K9t9sR0Cjd/P8kUAzI8trw5iP80rIlaW9im+vEyEFO5jeznknLR+zXp2azyv1umBzQKtfFl7eTjZdYEcDifVxOnXzO21qA+TpJUYUw27Hl6K9bA3oo/K6w6qMANN9EF8ybrTrYqbmnzT9XEvdejAmtbGIHotf0SwZbrKVpvmAngt78s/SJqauw/9RxYlaz9vmundel6sZb6tcEbZYD31j25PmtsU8+UcbaarU6GFWrd2ptc0bejWG8YDMKpMY0Nv5Djbiulv1NcMnzR1sVKCUyU40OnPyz8B+8RO/lpTt72iPv2ZgeWfda7aH2eaUDs+mY9BHE8rVsnJULsNBXB4eK1DR7C/okII+je+Kd039uoN1a3dqDyrrWqN/11zterBlS0D3PV3mA3u7nJvfxXcqaKxzL+ig2OfPqzzqJw295wgvoz9SuxpsSQ/oX325SGua2tnzpLmiJ1uvrivSneNkdWe+d2K1XU2El0bfq10NtqQGVLPEu8oyy10I7XvSnLZiUVOmGJEBLftPNp7ngjTVTvPpnso/ZEdREgP6ayuunxXPoLDzSXNpAUXTv1c1ahOS6WWpK6CLGDGGX9NJ7UowJjGgZbiIvgXMFLbzSXP7X9B7M8aoPdS/TbSQcjm/PpXbX/0Rk9mSGNBmeswUtvNJc0v76r3Jqlls4Dbt03Y9usyZNNxbw76eN/SRfNLcB+P13+3xM6zjbpe/DV/o3y9UU7sKrJF80lx3w0GlNgQYDJDS9T9SquLUbpV+y3Ihx0bySXNNijWlWxqs133sahW5Bo9wAl03WC7j2Eg+ac67eF+7uaFFzyj7YKjEmoAjo/iUj0wPo1kT6hbccc72pzaIILBEMaDHjJ9YwY9smj9Cw8p28lYEaKMY0DXdjOdp326Zd+j5goTH6IHjoxjQySNFZmrj2+t6iZ8OcsahFsEkigHtt1Bsbm7cK0I2BzrzIAVgjGJAo8RHzsvu2Fd7z9vZR2sAQxQDGnRZfH5Wq8GzX5e3GkAdwYDmdekUk9mwopO3foTilA3o4xNWdPk4G2byo7+cvPk4GFE2oD8UdporOc1kodQYOVYFzoHgLn62+UF1wKUQDGjyTHlXBY6MYEBj0WUTChEMaMRpeVcFjoxeQLUVXH7YJShCL6BpgfKuCRwavYDubyXvmsCh0QvokjflXRM4NHoBHYP2SlCEXUBtHZupu3M/nQukYRRQO8ZmauzMT/0BqdgE1J6xmbxMPj4RXBCbgNoxNpNIl05wYWwCasfYTEdFunSC6yI3NtNqkS6d4LrIjc00SaxLJ7gscmMzxWNoMNBDbmymyL0SVwROjfWdJMkP8qp2xbYVgXNiHVDDB3mdH1mg7Bzx8qa7dIJLYh1Qwwd5pU0t4LtNvPyZcNvWA05KrcYizU087n1rR3nXAw5OrcYipgI6+x2p6wGnplZjkeajFhqZ1KFXr4jGvVxbXAe1a0BATFEonlKpsciiBGNRbrVru1Wr7dqquatdA/VFlCwKRfJdFgG13FhEzJaXeP6eqw//uamL2jVQ38PyNnxJ5sYiYnQBdXkIqBIBtdxYRAwCyiOgOuwDarmxiBgElEdAddgH1HJjETEIKI+A6igQUIuNRcQgoDwCqqNIQG2AgPIIqA4CShgCSjegO15mvw7ytr2qdg3Ul21Lx0kFApprou2oS8FGEEg7d8mjQEABbIeAAmkIKJCGgAJpCCiQhoACaQgokIaAAmkIKJCGgAJpCCiQhoAq7uFlHYyIbh0GAc2dUbtinbm6sZi+aebZ+iivP8HzmtY95V8lPWY2wvonnRL6mf++MzAXhF9e8q4+QWPFQhgEdEqJ5JWJJcbzfGrJNxa18jyvNyGYz7lEQM1shOmBGwUn1K4he2a2wTmfFxcnclOtWIj8AdV6DRBeB1fI4aNba/l7ASP5ogmev+Tm5goBNbcREtuoXTtlmNsGA/4l/LAOt6aNrPwBvcZtEl6/4S6lc7pRlRNC+cIJYQcf3bulKwTU3EboMIB3iWEszGyDR+4pvJXjccof0Idn/xFeh5bNOsX9KEzMKqctnOD5z/3vuERAzW2EsMjwEjWnO/94qWa2wUUupVXZpz625v9TRmfxy0oN4XdxZ4Spr7i7hRP8pUqbeJcI6BPiGyG3jPfc1ERugtq1U4b4NjjAVXxv29jSY61YAJOAXuvGvZEt1OusML2cSy+c0EQL4XSVgJraCI9W6YYGjK/o/D+hprdBKveuMDG0ohU/oSwCurZyyAbhn5PcQeF1dllt4cQSrwuZmc3iMh8zWCk1JjdC3scbuN9VrJxCTG6Dw9xuYWKLNduAQUC/4eIf6v5N55YJr0khRRPD88Yl4TbKv1JqTG+Eqzt0l/82cX+qWDtlmNkG3FZed0H4huWFyB/QbN9++b8SUZ14/lGN94smLuwT1Gm7z/nvopjZCCef/HH6BZsZp9o5mNkG2nqvC7N7VbNiG8gf0L1c4nSdB3xqiWGpXT2FI67CCR2XOAY1sxG0Md7TV77FrVO7isyZC0IK12dFPLfCiqXIH9D/5O/Hb/L8msYe0cd08woneBcJqLmNkJkYWOn57SpXUAFmg/B1E7fnrBohEY1FgDQEFEhDQIE0BBRIQ0CBNAQUSENAgTQEFEhDQIE0BBRIQ0CBNAQUSENAgTQEFEhDQIE0BBRIQ0CBNAQUSENAgTQEFEhDQIE0BBRIQ0CBNAQUSENAgTQEFEhDQOWXpBvwJTjuV4OZ61epVBsHh4DKL8lj2bJF79Vw26M/s2cXtarj2BBQ+SX56V4zGkfoD6KMgNoGAZVfXkD5ndwWnr/7dmDZmh9r+GbCXj9Tu/i5inWxq5cEAZVffkBzS0/m+X5eY1MSuRT+auc253NnlHhnVS+rRsWEAgio/PIDytfoz/NdFwkTdd9/sou/76l7lln3UDXr5nAQUPnpB1RwI6Xc8CcBPcydFt5uLukKz5CQDQIqP/1d/KkX/avG+uUFdF3+kMNXVK6fQ0FA5ad3knS3YvxJLd8kL6AHuJ0/6WSpXD+HgoDKT+8y0y7uKs/frpQX0IwKS4X5C95y+ud7yAkBlZ/uQv3iETUq7eb5S6U6fzU7vHKjk3y/8L2PP6o4bu37JT9Ru34OBQGV35NbnUGv6s6I+JTQSi227wyYzh+o5fa3dladChGz8AMqBQIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpCGgQBoCCqQhoEAaAgqkIaBAGgIKpP0f6tbz9zBUy9gAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="conversion-of-corner-coordinates" class="section level3">
<h3>Conversion of corner coordinates</h3>
<p>Corner coordinates of the pixel area extracted are provided, these can be used to calculate the coverage of the extracted area. Coordinates are provided in the original sinusoidal grid coordinates and first have to be transformed into latitude longitude (for convenience).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># convert the coordinates</span>
lat_lon &lt;-<span class="st"> </span><span class="kw">sin_to_ll</span>(subset<span class="op">$</span>xllcorner, subset<span class="op">$</span>yllcorner)

<span class="co"># bind with the original dataframe</span>
subset &lt;-<span class="st"> </span><span class="kw">cbind</span>(subset, lat_lon)

<span class="kw">head</span>(subset)
<span class="co">#&gt;       xllcorner  yllcorner      cellsize nrows ncols              band</span>
<span class="co">#&gt; 1.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt; 2.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt; 3.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt; 4.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt; 5.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt; 6.1 -5914186.84 4729496.17 231.656358264     1     1 250m_16_days_NDVI</span>
<span class="co">#&gt;                     units  scale latitude longitude     site product</span>
<span class="co">#&gt; 1.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt; 2.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt; 3.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt; 4.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt; 5.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt; 6.1 NDVI ratio - No units 0.0001 42.53417   -72.179 testsite MOD13Q1</span>
<span class="co">#&gt;          start        end complete modis_date calendar_date   tile</span>
<span class="co">#&gt; 1.1 2004-01-01 2005-12-30     TRUE   A2004001    2004-01-01 h12v04</span>
<span class="co">#&gt; 2.1 2004-01-01 2005-12-30     TRUE   A2004017    2004-01-17 h12v04</span>
<span class="co">#&gt; 3.1 2004-01-01 2005-12-30     TRUE   A2004033    2004-02-02 h12v04</span>
<span class="co">#&gt; 4.1 2004-01-01 2005-12-30     TRUE   A2004049    2004-02-18 h12v04</span>
<span class="co">#&gt; 5.1 2004-01-01 2005-12-30     TRUE   A2004065    2004-03-05 h12v04</span>
<span class="co">#&gt; 6.1 2004-01-01 2005-12-30     TRUE   A2004081    2004-03-21 h12v04</span>
<span class="co">#&gt;         proc_date pixel value longitude_ll latitude_ll</span>
<span class="co">#&gt; 1.1 2015154120947     1 -3000    -72.17891    42.53333</span>
<span class="co">#&gt; 2.1 2015154121734     1  5108    -72.17891    42.53333</span>
<span class="co">#&gt; 3.1 2015154122102     1  3286    -72.17891    42.53333</span>
<span class="co">#&gt; 4.1 2015154125157     1  2115    -72.17891    42.53333</span>
<span class="co">#&gt; 5.1 2015154125222     1  4775    -72.17891    42.53333</span>
<span class="co">#&gt; 6.1 2015154125302     1  5687    -72.17891    42.53333</span></code></pre></div>
<p>Together with meta-data regarding cell size, number of columns and rows the bounding box of the extracted data can be calculated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># convert to bounding box</span>
bb &lt;-<span class="st"> </span><span class="kw">apply</span>(subset, <span class="dv">1</span>, <span class="cf">function</span>(x){
  <span class="kw">mt_bbox</span>(<span class="dt">xllcorner =</span> x[<span class="st">'xllcorner'</span>],
          <span class="dt">yllcorner =</span> x[<span class="st">'yllcorner'</span>],
           <span class="dt">cellsize =</span> x[<span class="st">'cellsize'</span>],
           <span class="dt">nrows =</span> x[<span class="st">'nrows'</span>],
           <span class="dt">ncols =</span> x[<span class="st">'ncols'</span>])
})

<span class="co"># plot one bounding box</span>
<span class="kw">plot</span>(bb[[<span class="dv">1</span>]])

<span class="co"># add the location of the queried coordinate within the polygon</span>
<span class="kw">points</span>(subset<span class="op">$</span>longitude[<span class="dv">1</span>],
       subset<span class="op">$</span>latitude[<span class="dv">1</span>],
       <span class="dt">pch =</span> <span class="dv">20</span>,
       <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
